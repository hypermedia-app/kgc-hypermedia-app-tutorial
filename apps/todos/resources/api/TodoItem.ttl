PREFIX hydra: <http://www.w3.org/ns/hydra/core#>
PREFIX schema: <http://schema.org/>
PREFIX sh: <http://www.w3.org/ns/shacl#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX acl: <http://www.w3.org/ns/auth/acl#>
PREFIX dash: <http://datashapes.org/dash#>
PREFIX knossos: <https://hypermedia.app/knossos#>
PREFIX auth: <https://hypermedia.app/auth#>
PREFIX code: <https://code.described.at/>

<#New>
  a sh:NodeShape ;
  sh:property
    [
      sh:name "Title" ;
      sh:path schema:name ;
      sh:minCount 1 ;
      sh:maxCount 1 ;
      sh:minLength 3 ;
    ] ;
.

<>
  a rdfs:Class, sh:NodeShape ;
  rdfs:subClassOf hydra:Resource ;
  sh:and ( </api/Resource> <#New> ) ;
  sh:property
    [
      sh:path schema:isPartOf ;
      sh:minCount 1 ;
      sh:maxCount 1 ;
      sh:class </api/TodoList> ;
      dash:readOnly true ;
    ],
    [
      sh:path schema:status ;
      sh:minCount 1 ;
      sh:maxCount 1 ;
      sh:in ( "IN PROGRESS" "COMPLETED" ) ;
      sh:message "Status must be 'IN PROGRESS' or 'COMPLETED'" ;
    ],
    [
      sh:path acl:owner ;
      sh:minCount 1 ;
      sh:maxCount 1 ;
      sh:class foaf:Person ;
      dash:readOnly true ;
    ] ;
  hydra:supportedOperation
    [
      a schema:UpdateAction ;
      auth:access acl:Update ;
      hydra:method "PUT" ;
      code:implementedBy
        [
          a code:EcmaScript ;
          code:link <node:@hydrofoil/knossos/resource#PUT> ;
        ] ;
    ] ;
  knossos:beforeSave
    [
      a code:EcmaScript ;
      code:link <node:@creta-todos/domain/resource#checkReadonlyProperties> ;
    ] ;
.
